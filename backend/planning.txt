class Player {
    readonly socketId: string
    readonly username: string
    hand: Card[]
    uno: boolean

    getHand(): Card[]
    addToHand(cards: Card[]): void

    removeCards(cardIds: string[]): Card[]

    setIsUno(isUno: boolean): void
    isUno(): boolean
}

class Card {
    id: string
    name: string
    color: CardColor
    value: CardValue
}

class GameBoard {
    id: string
    discardPile: Card[]
    drawPile: Card[] // This is a stack
    currentColor: string

    getId(): string

    getDiscardPile(): Card[]
    pushToDiscardPile(cards: Card[]): void
    clearDiscardPile(): Card[] // This is used to clean the discardPile and add to drawPile

    getDrawPile(): Card[]
    pushToDrawPile(cards: Card[]): void
    shuffleDrawPile(): void
    popFromDrawPile(amount: number): Card[]

    setCurrentColor(color: string): void
    getCurrentColor(): string
}

class GameRoom {
    id: string
    name: string
    ownerId: string // player.id
    maxPlayers: number
    full: boolean
    started: boolean
    gameBoard: GameBoard
    currentPlayers: Player[]
    
    // THIS IS TO BE CONSTRUCTED AFTER GAME HAS STARTED
    playerOrder: Player[]
    direction: number
    currentPlayerIndex: number

    getId(): string
    getOwnerId(): string
    getMaxPlayer(): number
    isFull(): boolean
    setHasStarted(started: boolean): void
    hasStarted(): boolean
    getGameBoard(): GameBoard
    
    getCurrentPlayers(): Player[]
    addCurrentPlayer(player: Player): void
    removeCurrentPlayer(player: Player): Player

    setPlayerOrder(players: Player[]): void
    getPlayerOrder(): Player[]
    removeFromPlayerOrder(player: Player): Player
    setDirection(direction: number): void
    getDirection(): number
    setCurrentPlayerIndex(index: number): void
    getCurrentPlayerIndex(): number
}

// @Injectable - Singleton
class GameService {
    rooms: Map<GameRoom> roomId, room

    ON SERVER CONNECTION
        - Establish websocket connection (/)

    1. Player create a room in the namespace: 
        - On "create-room" event:
            - Initialize Player based on their socket 
            - Create logical GameRoom 
            - Create a network room
            - Join current player to network room
            - Add them to GameRoom currentPlayer
            - Add GameRoom to rooms

    2. Players join created room:
        - On "join-room" event:
            If exists room id in rooms
            If room is not full
            If room hasnt started
                - Join them to network room
                - Add them to GameRoom currentPlayer
            Else
                Dont connect and emit error

    3. Players leave created room:
        - On "leave-room" event:
            - Disconnect them from network room
            - Remove them from currentPlayers

    4. If theres no Player in a room
        - Remove network room
        - Remove empty room

    5. Starting the game:
        - IMPLEMENT THIS LATER
}